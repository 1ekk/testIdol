local sampev=require("samp.events") require("Tasking") require("addon") newCoro=Tasking.new wait=Tasking.wait local pass="Kotik303" local autoheal=true function reset() spawned_at_gift=false is_logined=false pay_for_hotel=false miss_coords=false last_dialog=false td_last_clicked=os.time() end function onLoad() print("loaded") reset() newCoro(function() while true do if autoheal and pickup and is_logined then sendPickedUpPickup(pickup) end wait(5000) end end) newCoro(function() while true do if is_logined and os.time() > next_chest then print("Попытка открыть тайник Илона Маска") sendClickTextdraw(65535) if last_dialog then sendDialogResponse(last_dialog, 0, -1, "") end wait(1000) sendInput("/invent") next_chest=os.time() + 300 end wait(5000) end end) local f=io.open(getPath("pass.txt"), "r") if not f then return end pass=f:read("*a") f:close() end function onUpdate() Tasking.tick() end function onDisconnect() reset() end function sampev.onDisplayGameText(style, time, text) if text == "Full health" then return false end end function sampev.onSetInterior(id) if id ~= 85 then print("Неправильный интерьер!!!:", id) is_logined=false miss_coords=true end end function sampev.onCreatePickup(id, model, type, pos) if model == 1240 and type == 1 then pickup=id print("health pickup:", id) end end function sampev.onDestroyPickup(id) if id == pickup then pickup=nil end end function sampev.onSendPlayerSync(data) if is_logined and os.time() >= next_alt then next_alt=os.time() + 600 print("Отправка альта") data.keysData=1024 end end function sampev.onSetPlayerPos(pos) if miss_coords or is_logined then return end pos={ x=math.floor(pos.x), y=math.floor(pos.y), z=math.floor(pos.z)} if pos.x == 1362 and pos.y == 77 and pos.z == 1010 then print("Бот успешно заспавнился") setPosition(1356.9784, 73.7018, 1010.8850) is_logined=true next_alt=os.time() + 10 next_chest=os.time() + 20 payHotel() return false else miss_coords=true end end function sampev.onServerMessage(color, text) if text:find("Вы закончили лечение") then reconnect() end end function sampev.onShowDialog(id, style, title, btn1, btn2, text) last_dialog=id if title == "{BFBBBA}Акции на Arizona Role Play" then return false end print(string.format("показан диалог: \"%s\"[%d]", title, id)) local function _sendDialogResponse(button, list, input) local bs=bitStream.new() bs:writeUInt16(id) bs:writeUInt8(button) bs:writeUInt16(list) bs:writeUInt8(input:len()) bs:writeString(input) bs:sendRPC(62) return false end if id == 2 then return _sendDialogResponse(1, -1, pass) end if pay_for_hotel then if title == "{BFBBBA}Меню " and text:find("Проплата за проживание") then return _sendDialogResponse(1, 1, "") elseif title == "{BFBBBA}Меню" and text:find("Введите количество часов") then local hours=text:match("проплатить (%d+) часов") pay_for_hotel=false return _sendDialogResponse((not hours or hours == "0" ) and 0 or 1 , -1, hours) end end end function sampev.onShowTextDraw(id, data) if data.modelId == 1733 and data.text == "LD_SPAC:white" and os.time() - td_last_clicked > 5 then td_last_clicked=os.time() newCoro(function() wait(2000) sendClickTextdraw(id) end) elseif data.text == "USE" then newCoro(function() wait(2000) sendClickTextdraw(id + 1) wait(2000) sendClickTextdraw(65535) end) end return false end function payHotel() print("проплачиваем отель...") pay_for_hotel=true sendInput("/hotel") end function onRunCommand(cmd) if cmd == "!eh" then autoheal=not autoheal print("autoheal:", autoheal) return false elseif cmd == "!hotel" then payHotel() return false end end